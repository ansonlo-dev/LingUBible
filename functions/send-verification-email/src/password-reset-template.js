// 密碼重設郵件模板生成器
export function generatePasswordResetEmailTemplate(email, resetUrl, language = 'zh-TW') {
  // 多語言翻譯
  const translations = {
    'en': {
      preview: 'Reset your LingUBible password',
      title: 'Password Reset Request',
      greeting: 'Dear Lingnanians,',
      requestReceived: 'We received a password reset request for your LingUBible account. Click the button below to reset your password:',
      resetButton: 'Reset Password',
      importantReminder: 'Important Security Notice:',
      expiry: 'This reset link will expire in 24 hours',
      noRequest: 'If you didn\'t request a password reset, please ignore this email',
      noShare: 'Do not share this link with others',
      manualLink: 'If the button doesn\'t work, copy and paste this link into your browser:',
      notice: 'Notice: Only Lingnan University Lingnanians with @ln.hk or @ln.edu.hk email addresses can use LingUBible.',
      support: 'If you have any questions, please contact our technical support team.',
      platform: 'Lingnan University Course & Lecturer Review Platform',
      license: 'Licensed under MIT',
      team: 'LingUBible Team',
      autoGenerated: 'This email was sent automatically by LingUBible system, please do not reply.'
    },
    'zh-TW': {
      preview: '重設您的 LingUBible 密碼',
      title: '密碼重設請求',
      greeting: '親愛的嶺南人，您好！',
      requestReceived: '我們收到了您的 LingUBible 帳戶密碼重設請求。請點擊下方按鈕來重設您的密碼：',
      resetButton: '重設密碼',
      importantReminder: '重要安全提醒：',
      expiry: '此重設連結將在 24 小時後過期',
      noRequest: '如果您沒有請求密碼重設，請忽略此郵件',
      noShare: '請勿將此連結分享給他人',
      manualLink: '如果按鈕無法點擊，請複製以下連結到瀏覽器：',
      notice: '注意事項：只有使用 @ln.hk 或 @ln.edu.hk 郵件地址的嶺南大學嶺南人才能使用 LingUBible。',
      support: '如有任何問題，請聯繫我們的技術支援團隊。',
      platform: '嶺南大學課程與講師評價平台',
      license: '採用 MIT 授權',
      team: 'LingUBible 團隊',
      autoGenerated: '此郵件由 LingUBible 系統自動發送，請勿回覆。'
    },
    'zh-CN': {
      preview: '重设您的 LingUBible 密码',
      title: '密码重设请求',
      greeting: '亲爱的岭南人，您好！',
      requestReceived: '我们收到了您的 LingUBible 账户密码重设请求。请点击下方按钮来重设您的密码：',
      resetButton: '重设密码',
      importantReminder: '重要安全提醒：',
      expiry: '此重设链接将在 24 小时后过期',
      noRequest: '如果您没有请求密码重设，请忽略此邮件',
      noShare: '请勿将此链接分享给他人',
      manualLink: '如果按钮无法点击，请复制以下链接到浏览器：',
      notice: '注意事项：只有使用 @ln.hk 或 @ln.edu.hk 邮件地址的岭南大学岭南人才能使用 LingUBible。',
      support: '如有任何问题，请联系我们的技术支持团队。',
      platform: '岭南大学课程与讲师评价平台',
      license: '采用 MIT 授权',
      team: 'LingUBible 团队',
      autoGenerated: '此邮件由 LingUBible 系统自动发送，请勿回复。'
    }
  };

  const t = translations[language] || translations['zh-TW'];

  // 生成 HTML 模板
  const htmlTemplate = `
    <!DOCTYPE html>
    <html lang="${language === 'en' ? 'en' : language === 'zh-CN' ? 'zh-CN' : 'zh-HK'}">
    <head>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>LingUBible ${t.title}</title>
      <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
        
        body {
          margin: 0;
          padding: 0;
          font-family: 'Inter', Arial, 'Microsoft JhengHei', sans-serif;
          background-color: #f6f9fc;
          line-height: 1.6;
        }
        
        .container {
          margin: 0 auto;
          padding: 20px 0;
          width: 600px;
          max-width: 100%;
          background-color: #ffffff;
          border-radius: 8px;
          box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .header {
          padding: 40px 40px 30px;
          text-align: center;
          border-bottom: 1px solid #eee;
        }
        
        .logo-container {
          display: inline-flex;
          align-items: center;
          justify-content: center;
          gap: 12px;
          margin-bottom: 8px;
          text-decoration: none;
          color: inherit;
        }
        
        .logo {
          width: 48px;
          height: 48px;
          vertical-align: middle;
        }
        
        .brand-name {
          margin: 0;
          color: #dc2626;
          font-size: 28px;
          font-weight: bold;
          vertical-align: middle;
        }
        
        .platform-text {
          margin: 5px 0 0;
          color: #666;
          font-size: 14px;
        }
        
        .content {
          padding: 40px;
        }
        
        .title {
          margin: 0 0 30px;
          color: #333;
          text-align: center;
          font-size: 24px;
          font-weight: 600;
        }
        
        .text {
          margin: 0 0 30px;
          color: #333;
          font-size: 16px;
        }
        
        .button-section {
          text-align: center;
          padding: 30px 0;
        }
        
        .reset-button {
          display: inline-block;
          background-color: #dc2626;
          color: white !important;
          text-decoration: none;
          padding: 16px 32px;
          border-radius: 8px;
          font-size: 16px;
          font-weight: 600;
          transition: background-color 0.3s ease;
        }
        
        .reset-button:hover {
          background-color: #b91c1c;
        }
        
        .manual-link {
          margin: 30px 0;
          padding: 20px;
          background-color: #f8f9fa;
          border: 1px solid #e9ecef;
          border-radius: 8px;
          word-break: break-all;
          font-size: 14px;
          color: #666;
        }
        
        .link-text {
          color: #dc2626;
          text-decoration: none;
        }
        
        .reminder-title {
          margin: 0 0 20px;
          color: #333;
          font-size: 16px;
          font-weight: bold;
        }
        
        .reminder-list {
          margin: 0 0 30px;
          color: #333;
          font-size: 16px;
          padding-left: 20px;
        }
        
        .reminder-item {
          margin-bottom: 8px;
        }
        
        .notice {
          margin: 0 0 30px;
          color: #333;
          font-size: 16px;
          font-weight: bold;
        }
        
        .footer {
          padding: 30px 40px;
          background-color: #f8f9fa;
          text-align: center;
          border-radius: 0 0 8px 8px;
          border-top: 1px solid #eee;
        }
        
        .footer-text {
          margin: 0 0 10px;
          color: #8898aa;
          font-size: 12px;
        }
        
        .footer-link {
          color: #8898aa;
          text-decoration: none;
        }
        
        /* 深色主題支援 */
        @media (prefers-color-scheme: dark) {
          body {
            background-color: #1a1a1a !important;
          }
          
          .container {
            background-color: #2d2d2d !important;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3) !important;
          }
          
          .header {
            border-bottom: 1px solid #404040 !important;
          }
          
          .brand-name {
            color: #ef4444 !important;
          }
          
          .platform-text {
            color: #a0a0a0 !important;
          }
          
          .title {
            color: #f0f0f0 !important;
          }
          
          .text {
            color: #e0e0e0 !important;
          }
          
          .reset-button {
            background-color: #ef4444 !important;
          }
          
          .reset-button:hover {
            background-color: #dc2626 !important;
          }
          
          .manual-link {
            background-color: #1f1f1f !important;
            border: 1px solid #404040 !important;
            color: #a0a0a0 !important;
          }
          
          .link-text {
            color: #ef4444 !important;
          }
          
          .reminder-title {
            color: #f0f0f0 !important;
          }
          
          .reminder-list {
            color: #e0e0e0 !important;
          }
          
          .notice {
            color: #f0f0f0 !important;
          }
          
          .footer {
            background-color: #1f1f1f !important;
            border-top: 1px solid #404040 !important;
          }
          
          .footer-text {
            color: #a0a0a0 !important;
          }
          
          .footer-link {
            color: #a0a0a0 !important;
          }
        }
        
        /* Outlook 深色主題支援 */
        [data-ogsc] body {
          background-color: #1a1a1a !important;
        }
        
        [data-ogsc] .container {
          background-color: #2d2d2d !important;
        }
        
        [data-ogsc] .title,
        [data-ogsc] .text,
        [data-ogsc] .reminder-title,
        [data-ogsc] .reminder-list,
        [data-ogsc] .notice {
          color: #e0e0e0 !important;
        }
        
        [data-ogsc] .brand-name {
          color: #ef4444 !important;
        }
        
        [data-ogsc] .platform-text,
        [data-ogsc] .footer-text,
        [data-ogsc] .footer-link {
          color: #a0a0a0 !important;
        }
        
        [data-ogsc] .reset-button {
          background-color: #ef4444 !important;
        }
        
        [data-ogsc] .manual-link {
          background-color: #1f1f1f !important;
          border-color: #404040 !important;
          color: #a0a0a0 !important;
        }
        
        [data-ogsc] .link-text {
          color: #ef4444 !important;
        }
        
        [data-ogsc] .footer {
          background-color: #1f1f1f !important;
        }
        
        [data-ogsc] .header {
          border-bottom-color: #404040 !important;
        }
        
        @media (max-width: 600px) {
          .container {
            width: 100%;
            margin: 0;
            border-radius: 0;
          }
          
          .header, .content, .footer {
            padding: 20px;
          }
          
          .reset-button {
            padding: 14px 24px;
            font-size: 14px;
          }
        }
      </style>
    </head>
    <body>
      <div class="container">
        <!-- Header -->
        <div class="header">
          <a href="https://lingubible.com" class="logo-container">
            <svg class="logo" viewBox="0 0 512 512" fill="none" xmlns="http://www.w3.org/2000/svg">
              <rect x="32" y="32" width="448" height="448" rx="80" fill="#dc2626"/>
              <g transform="translate(128, 160)">
                <path d="M0 24 C0 12 12 0 24 0 L104 0 C116 0 128 12 128 24 L128 176 C128 188 116 200 104 200 L24 200 C12 200 0 188 0 176 Z" fill="white"/>
                <path d="M128 24 C128 12 140 0 152 0 L232 0 C244 0 256 12 256 24 L256 176 C256 188 244 200 232 200 L152 200 C140 200 128 188 128 176 Z" fill="white"/>
                <line x1="128" y1="24" x2="128" y2="200" stroke="#dc2626" stroke-width="6"/>
                <path d="M116 200 L116 256 L128 244 L140 256 L140 200" fill="#dc2626"/>
              </g>
            </svg>
            <h1 class="brand-name">LingUBible</h1>
          </a>
          <p class="platform-text">${t.platform}</p>
        </div>

        <!-- Content -->
        <div class="content">
          <h2 class="title">${t.title}</h2>
          
          <p class="text">${t.greeting}</p>
          
          <p class="text">${t.requestReceived}</p>
          
          <!-- Reset Button -->
          <div class="button-section">
            <a href="${resetUrl}" class="reset-button">${t.resetButton}</a>
          </div>
          
          <!-- Manual Link -->
          <div class="manual-link">
            <p style="margin: 0 0 10px; color: #666;">${t.manualLink}</p>
            <a href="${resetUrl}" class="link-text">${resetUrl}</a>
          </div>
          
          <p class="reminder-title">${t.importantReminder}</p>
          
          <ul class="reminder-list">
            <li class="reminder-item">${t.expiry}</li>
            <li class="reminder-item">${t.noRequest}</li>
            <li class="reminder-item">${t.noShare}</li>
          </ul>
          
          <p class="notice">${t.notice}</p>
          
          <p class="text">${t.support}</p>
          
          <p class="text" style="font-size: 14px; color: #8898aa;">${t.autoGenerated}</p>
        </div>

        <!-- Footer -->
        <div class="footer">
          <p class="footer-text">
            <a href="https://lingubible.com" class="footer-link">LingUBible</a> - ${t.platform}
          </p>
          <p class="footer-text">${t.license}</p>
        </div>
      </div>
    </body>
    </html>
  `;

  // 生成純文字版本
  const textTemplate = `
${t.greeting}

${t.requestReceived}

${t.resetButton}: ${resetUrl}

${t.importantReminder}
- ${t.expiry}
- ${t.noRequest}
- ${t.noShare}

${t.manualLink}
${resetUrl}

${t.notice}

${t.support}

${t.autoGenerated}

${t.team}
  `;

  return {
    html: htmlTemplate,
    text: textTemplate.trim(),
    subject: language === 'en' 
      ? '【LingUBible】Password Reset Request - Do Not Reply'
      : language === 'zh-CN'
      ? '【LingUBible】密码重设请求 - 请勿回复'
      : '【LingUBible】密碼重設請求 - 請勿回覆'
  };
} 