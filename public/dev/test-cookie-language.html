<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cookie èªè¨€æª¢æ¸¬æ¸¬è©¦</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
            background: #f8fafc;
        }
        .container {
            background: white;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }
        .button {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            margin: 8px 8px 8px 0;
            transition: background 0.2s;
        }
        .button:hover {
            background: #2563eb;
        }
        .button.secondary {
            background: #6b7280;
        }
        .button.secondary:hover {
            background: #4b5563;
        }
        .log {
            background: #1f2937;
            color: #f9fafb;
            padding: 16px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
            white-space: pre-wrap;
        }
        .status {
            padding: 12px;
            border-radius: 8px;
            margin: 12px 0;
        }
        .status.success {
            background: #dcfce7;
            color: #166534;
            border: 1px solid #bbf7d0;
        }
        .status.warning {
            background: #fef3c7;
            color: #92400e;
            border: 1px solid #fde68a;
        }
        .status.info {
            background: #dbeafe;
            color: #1e40af;
            border: 1px solid #bfdbfe;
        }
        .test-section {
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            padding: 16px;
            margin: 16px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸª Cookie èªè¨€æª¢æ¸¬æ¸¬è©¦</h1>
        <p>é€™å€‹é é¢ç”¨ä¾†æ¸¬è©¦ Cookie åŒæ„å½ˆçª—çš„èªè¨€æª¢æ¸¬åŠŸèƒ½ã€‚</p>
    </div>

    <div class="container">
        <h2>ğŸ“Š ç•¶å‰ç‹€æ…‹</h2>
        <div id="current-status">
            <div class="status info">
                <strong>ç€è¦½å™¨èªè¨€ï¼š</strong><span id="browser-lang">æª¢æ¸¬ä¸­...</span>
            </div>
            <div class="status info">
                <strong>æª¢æ¸¬åˆ°çš„èªè¨€ï¼š</strong><span id="detected-lang">æª¢æ¸¬ä¸­...</span>
            </div>
            <div class="status info">
                <strong>Cookie ä¸­çš„èªè¨€ï¼š</strong><span id="cookie-lang">æª¢æ¸¬ä¸­...</span>
            </div>
            <div class="status info">
                <strong>Cookie åŒæ„ç‹€æ…‹ï¼š</strong><span id="cookie-consent">æª¢æ¸¬ä¸­...</span>
            </div>
        </div>
    </div>

    <div class="container">
        <h2>ğŸ§ª æ¸¬è©¦æ“ä½œ</h2>
        <div class="test-section">
            <h3>èªè¨€æ¨¡æ“¬æ¸¬è©¦</h3>
            <p>æ¨¡æ“¬ä¸åŒçš„ç€è¦½å™¨èªè¨€è¨­å®šï¼š</p>
            <button class="button" onclick="simulateLanguage('zh-TW')">æ¨¡æ“¬ç¹é«”ä¸­æ–‡ (zh-TW)</button>
            <button class="button" onclick="simulateLanguage('zh-CN')">æ¨¡æ“¬ç°¡é«”ä¸­æ–‡ (zh-CN)</button>
            <button class="button" onclick="simulateLanguage('en-US')">æ¨¡æ“¬è‹±æ–‡ (en-US)</button>
            <button class="button" onclick="simulateLanguage('ja-JP')">æ¨¡æ“¬æ—¥æ–‡ (ja-JP)</button>
        </div>
        
        <div class="test-section">
            <h3>Cookie ç®¡ç†</h3>
            <button class="button secondary" onclick="clearAllCookies()">æ¸…é™¤æ‰€æœ‰ Cookie</button>
            <button class="button secondary" onclick="clearLanguageCookie()">æ¸…é™¤èªè¨€ Cookie</button>
            <button class="button secondary" onclick="clearConsentCookie()">æ¸…é™¤åŒæ„ Cookie</button>
            <button class="button secondary" onclick="refreshPage()">é‡æ–°è¼‰å…¥é é¢</button>
        </div>
        
        <div class="test-section">
            <h3>æ‰‹å‹•æ¸¬è©¦</h3>
            <p>æ‰‹å‹•è¨­å®šèªè¨€ä¸¦æ¸¬è©¦ Cookie å½ˆçª—ï¼š</p>
            <select id="manual-lang-select">
                <option value="zh-TW">ç¹é«”ä¸­æ–‡</option>
                <option value="zh-CN">ç°¡é«”ä¸­æ–‡</option>
                <option value="en">English</option>
            </select>
            <button class="button" onclick="setManualLanguage()">è¨­å®šèªè¨€</button>
            <button class="button" onclick="triggerCookiePopup()">è§¸ç™¼ Cookie å½ˆçª—</button>
        </div>
    </div>

    <div class="container">
        <h2>ğŸ“ æ¸¬è©¦æ—¥èªŒ</h2>
        <button class="button secondary" onclick="clearLog()">æ¸…é™¤æ—¥èªŒ</button>
        <div class="log" id="test-log">ç­‰å¾…æ¸¬è©¦æ“ä½œ...</div>
    </div>

    <div class="container">
        <h2>ğŸ” é æœŸè¡Œç‚º</h2>
        <div class="test-section">
            <h3>æ­£ç¢ºçš„èªè¨€æª¢æ¸¬æµç¨‹ï¼š</h3>
            <ol>
                <li><strong>é¦–æ¬¡è¨ªå•ï¼š</strong>æª¢æ¸¬ç€è¦½å™¨èªè¨€ â†’ è¨­å®šå°æ‡‰èªè¨€ â†’ ä¿å­˜åˆ° Cookie â†’ Cookie å½ˆçª—é¡¯ç¤ºå°æ‡‰èªè¨€</li>
                <li><strong>å†æ¬¡è¨ªå•ï¼š</strong>è®€å– Cookie ä¸­çš„èªè¨€ â†’ ç›´æ¥ä½¿ç”¨è©²èªè¨€ â†’ Cookie å½ˆçª—ï¼ˆå¦‚æœéœ€è¦ï¼‰é¡¯ç¤ºè©²èªè¨€</li>
                <li><strong>èªè¨€è®Šæ›´ï¼š</strong>ç”¨æˆ¶æ‰‹å‹•åˆ‡æ›èªè¨€ â†’ æ›´æ–° Cookie â†’ å¾ŒçºŒ Cookie å½ˆçª—ä½¿ç”¨æ–°èªè¨€</li>
            </ol>
        </div>
        
        <div class="test-section">
            <h3>æ¸¬è©¦å ´æ™¯ï¼š</h3>
            <ul>
                <li>æ¸…é™¤æ‰€æœ‰ Cookie â†’ é‡æ–°è¼‰å…¥ â†’ æª¢æŸ¥ Cookie å½ˆçª—èªè¨€æ˜¯å¦åŒ¹é…ç€è¦½å™¨èªè¨€</li>
                <li>è¨­å®šä¸åŒèªè¨€ â†’ æ¸…é™¤åŒæ„ Cookie â†’ æª¢æŸ¥å½ˆçª—èªè¨€æ˜¯å¦æ­£ç¢º</li>
                <li>æ¨¡æ“¬ä¸åŒç€è¦½å™¨èªè¨€ â†’ æª¢æŸ¥èªè¨€æª¢æ¸¬é‚è¼¯</li>
            </ul>
        </div>
    </div>

    <script>
        let logContainer = document.getElementById('test-log');

        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = `[${timestamp}] ${type.toUpperCase()}: ${message}\n`;
            logContainer.textContent += logEntry;
            logContainer.scrollTop = logContainer.scrollHeight;
            console.log(`Cookie Test: ${message}`);
        }

        function clearLog() {
            logContainer.textContent = 'æ—¥èªŒå·²æ¸…é™¤\n';
        }

        function updateStatus() {
            // ç€è¦½å™¨èªè¨€
            const browserLang = navigator.language || navigator.languages?.[0] || 'unknown';
            document.getElementById('browser-lang').textContent = browserLang;

            // Cookie ä¸­çš„èªè¨€
            const cookieLang = getCookie('language') || 'æœªè¨­å®š';
            document.getElementById('cookie-lang').textContent = cookieLang;

            // Cookie åŒæ„ç‹€æ…‹
            const consentStatus = localStorage.getItem('cookieConsent') || 'æœªè¨­å®š';
            document.getElementById('cookie-consent').textContent = consentStatus;

            // æª¢æ¸¬åˆ°çš„èªè¨€ï¼ˆæ¨¡æ“¬èªè¨€æª¢æ¸¬é‚è¼¯ï¼‰
            let detectedLang = 'en'; // é»˜èª
            if (browserLang) {
                if (browserLang.startsWith('zh-TW') || 
                    browserLang.startsWith('zh-Hant') || 
                    browserLang === 'zh-HK' || 
                    browserLang === 'zh-MO') {
                    detectedLang = 'zh-TW';
                } else if (browserLang.startsWith('zh-CN') || 
                           browserLang.startsWith('zh-Hans') || 
                           browserLang.startsWith('zh-SG') || 
                           browserLang === 'zh') {
                    detectedLang = 'zh-CN';
                } else if (browserLang.startsWith('en')) {
                    detectedLang = 'en';
                }
            }
            document.getElementById('detected-lang').textContent = detectedLang;

            log(`ç‹€æ…‹æ›´æ–° - ç€è¦½å™¨: ${browserLang}, æª¢æ¸¬: ${detectedLang}, Cookie: ${cookieLang}, åŒæ„: ${consentStatus}`);
        }

        function getCookie(name) {
            const value = `; ${document.cookie}`;
            const parts = value.split(`; ${name}=`);
            if (parts.length === 2) return parts.pop().split(';').shift();
            return null;
        }

        function setCookie(name, value, days = 365) {
            const expires = new Date();
            expires.setTime(expires.getTime() + days * 24 * 60 * 60 * 1000);
            document.cookie = `${name}=${value};expires=${expires.toUTCString()};path=/`;
            log(`è¨­å®š Cookie: ${name}=${value}`);
        }

        function simulateLanguage(lang) {
            log(`æ¨¡æ“¬ç€è¦½å™¨èªè¨€: ${lang}`);
            // æ³¨æ„ï¼šå¯¦éš›ä¸Šç„¡æ³•ä¿®æ”¹ navigator.languageï¼Œé€™è£¡åªæ˜¯è¨˜éŒ„
            // å¯¦éš›æ¸¬è©¦éœ€è¦åœ¨ç€è¦½å™¨è¨­å®šä¸­ä¿®æ”¹èªè¨€
            alert(`æ³¨æ„ï¼šç„¡æ³•ç›´æ¥ä¿®æ”¹ç€è¦½å™¨èªè¨€ã€‚è«‹åœ¨ç€è¦½å™¨è¨­å®šä¸­å°‡èªè¨€æ”¹ç‚º ${lang}ï¼Œç„¶å¾Œé‡æ–°è¼‰å…¥é é¢é€²è¡Œæ¸¬è©¦ã€‚`);
        }

        function clearAllCookies() {
            document.cookie.split(";").forEach(function(c) { 
                document.cookie = c.replace(/^ +/, "").replace(/=.*/, "=;expires=" + new Date().toUTCString() + ";path=/"); 
            });
            localStorage.clear();
            log('å·²æ¸…é™¤æ‰€æœ‰ Cookie å’Œ localStorage');
            updateStatus();
        }

        function clearLanguageCookie() {
            document.cookie = "language=;expires=" + new Date().toUTCString() + ";path=/";
            log('å·²æ¸…é™¤èªè¨€ Cookie');
            updateStatus();
        }

        function clearConsentCookie() {
            localStorage.removeItem('cookieConsent');
            log('å·²æ¸…é™¤åŒæ„ Cookie');
            updateStatus();
        }

        function refreshPage() {
            log('é‡æ–°è¼‰å…¥é é¢...');
            window.location.reload();
        }

        function setManualLanguage() {
            const selectedLang = document.getElementById('manual-lang-select').value;
            setCookie('language', selectedLang);
            log(`æ‰‹å‹•è¨­å®šèªè¨€ç‚º: ${selectedLang}`);
            updateStatus();
        }

        function triggerCookiePopup() {
            clearConsentCookie();
            log('å·²æ¸…é™¤åŒæ„ç‹€æ…‹ï¼ŒCookie å½ˆçª—æ‡‰è©²æœƒåœ¨ä¸»æ‡‰ç”¨ä¸­é¡¯ç¤º');
            alert('å·²æ¸…é™¤ Cookie åŒæ„ç‹€æ…‹ã€‚è«‹è¿”å›ä¸»æ‡‰ç”¨æŸ¥çœ‹ Cookie å½ˆçª—æ˜¯å¦ä»¥æ­£ç¢ºèªè¨€é¡¯ç¤ºã€‚');
        }

        // åˆå§‹åŒ–
        log('Cookie èªè¨€æª¢æ¸¬æ¸¬è©¦é é¢è¼‰å…¥å®Œæˆ');
        updateStatus();
        
        // å®šæœŸæ›´æ–°ç‹€æ…‹
        setInterval(updateStatus, 2000);
    </script>
</body>
</html> 