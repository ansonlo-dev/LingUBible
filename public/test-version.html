<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>版本顯示測試</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .test-container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .version-badge {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 6px 12px;
            background-color: #fed7aa;
            color: #ea580c;
            border-radius: 6px;
            text-decoration: none;
            font-size: 12px;
            font-weight: 500;
            transition: all 0.2s;
        }
        .version-badge:hover {
            background-color: #fdba74;
            transform: scale(1.05);
        }
        .external-icon {
            width: 12px;
            height: 12px;
        }
        .test-result {
            margin-top: 10px;
            padding: 10px;
            border-radius: 4px;
        }
        .success {
            background-color: #dcfce7;
            color: #166534;
        }
        .error {
            background-color: #fecaca;
            color: #dc2626;
        }
        .info {
            background-color: #dbeafe;
            color: #1d4ed8;
        }
    </style>
</head>
<body>
    <h1>🧪 版本顯示測試</h1>
    
    <div class="test-container">
        <h2>1. 靜態版本徽章測試</h2>
        <p>這是一個靜態的版本徽章，應該可以點擊跳轉到 GitHub：</p>
        <a href="https://github.com/ansonlo-dev/LingUBible/releases/tag/v0.0.5" 
           target="_blank" 
           rel="noopener noreferrer"
           class="version-badge">
            <svg class="external-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path>
            </svg>
            Beta 0.0.5
        </a>
        <div id="static-test-result" class="test-result info">
            點擊上方徽章測試靜態連結功能
        </div>
    </div>

    <div class="test-container">
        <h2>2. GitHub API 測試</h2>
        <p>測試 GitHub API 是否能正常獲取版本資訊：</p>
        <button onclick="testGitHubAPI()" style="padding: 8px 16px; background: #3b82f6; color: white; border: none; border-radius: 4px; cursor: pointer;">
            測試 GitHub API
        </button>
        <div id="api-test-result" class="test-result info">
            點擊按鈕測試 GitHub API
        </div>
        <div id="token-status" class="test-result info" style="margin-top: 10px;">
            檢查 GitHub Token 狀態...
        </div>
    </div>

    <div class="test-container">
        <h2>3. 本地版本資訊</h2>
        <p>當前 package.json 中的版本：</p>
        <div id="local-version" class="test-result info">
            載入中...
        </div>
    </div>

    <div class="test-container">
        <h2>4. 瀏覽器控制台</h2>
        <p>請打開瀏覽器開發者工具的控制台查看詳細日誌</p>
        <div class="test-result info">
            按 F12 打開開發者工具，查看 Console 標籤
        </div>
    </div>

    <script>
        console.log('🧪 版本測試頁面載入');
        
        // 測試 GitHub API
        async function testGitHubAPI() {
            const resultDiv = document.getElementById('api-test-result');
            resultDiv.textContent = '測試中...';
            resultDiv.className = 'test-result info';
            
            try {
                console.log('📡 測試 GitHub API...');
                const response = await fetch('https://api.github.com/repos/ansonlo-dev/LingUBible/releases/latest');
                console.log('📡 API 回應狀態:', response.status);
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const data = await response.json();
                console.log('📡 API 回應資料:', data);
                
                resultDiv.innerHTML = `
                    <strong>✅ API 測試成功</strong><br>
                    標籤: ${data.tag_name}<br>
                    名稱: ${data.name}<br>
                    URL: <a href="${data.html_url}" target="_blank">${data.html_url}</a><br>
                    發布時間: ${new Date(data.published_at).toLocaleString()}
                `;
                resultDiv.className = 'test-result success';
                
            } catch (error) {
                console.error('❌ API 測試失敗:', error);
                resultDiv.innerHTML = `
                    <strong>❌ API 測試失敗</strong><br>
                    錯誤: ${error.message}<br>
                    這可能是因為：<br>
                    • GitHub Release 尚未創建<br>
                    • 倉庫是私有的<br>
                    • API 限制<br>
                    • 網路問題
                `;
                resultDiv.className = 'test-result error';
            }
        }
        
        // 顯示本地版本
        function showLocalVersion() {
            const localVersionDiv = document.getElementById('local-version');
            // 模擬從 package.json 獲取版本
            const version = '0.0.5'; // 這應該從實際的 package.json 獲取
            localVersionDiv.innerHTML = `
                <strong>本地版本:</strong> ${version}<br>
                <strong>格式化版本:</strong> Beta ${version}<br>
                <strong>狀態:</strong> Beta 版本<br>
                <strong>預期 Release URL:</strong> <a href="https://github.com/ansonlo-dev/LingUBible/releases/tag/v${version}" target="_blank">
                    https://github.com/ansonlo-dev/LingUBible/releases/tag/v${version}
                </a>
            `;
        }
        
        // 檢查 GitHub Token 狀態
        function checkTokenStatus() {
            const tokenStatusDiv = document.getElementById('token-status');
            
            // 模擬檢查環境變數（在實際應用中這會從 import.meta.env 獲取）
            const hasToken = false; // 在測試頁面中無法真正檢查環境變數
            
            if (hasToken) {
                tokenStatusDiv.innerHTML = '✅ GitHub Token 已配置';
                tokenStatusDiv.className = 'test-result success';
            } else {
                tokenStatusDiv.innerHTML = `
                    ⚠️ GitHub Token 未配置<br>
                    <small>
                        • 如果倉庫是私有的，需要配置 GitHub Token<br>
                        • 參考文檔：<a href="/docs/setup/GITHUB_TOKEN_SETUP.md" target="_blank">GitHub Token 設置指南</a><br>
                        • 環境變數：VITE_GITHUB_TOKEN
                    </small>
                `;
                tokenStatusDiv.className = 'test-result info';
            }
        }

        // 頁面載入時執行
        document.addEventListener('DOMContentLoaded', function() {
            console.log('📄 頁面載入完成');
            showLocalVersion();
            checkTokenStatus();
            
            // 測試靜態連結點擊
            document.querySelector('.version-badge').addEventListener('click', function(e) {
                console.log('🔗 靜態版本徽章被點擊');
                document.getElementById('static-test-result').innerHTML = '✅ 靜態連結點擊成功！正在跳轉...';
                document.getElementById('static-test-result').className = 'test-result success';
            });
        });
    </script>
</body>
</html> 