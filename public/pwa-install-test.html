<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PWA 安裝指引多語言測試 - LingUBible</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
        }
        .container {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        h1 {
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }
        .language-selector {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 30px;
        }
        .lang-btn {
            padding: 10px 20px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
        }
        .lang-btn:hover, .lang-btn.active {
            background: rgba(255, 255, 255, 0.2);
            border-color: rgba(255, 255, 255, 0.6);
            transform: translateY(-2px);
        }
        .install-section {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .install-steps {
            list-style: none;
            padding: 0;
        }
        .install-steps li {
            background: rgba(255, 255, 255, 0.1);
            margin: 10px 0;
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid #4CAF50;
        }
        .browser-specific {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }
        .browser-specific ul {
            list-style: none;
            padding: 0;
        }
        .browser-specific li {
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        .test-btn {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            margin: 10px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        .test-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }
        .status {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            font-family: monospace;
        }
        .log {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            font-family: monospace;
            font-size: 14px;
            max-height: 300px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 id="title">🌐 PWA 安裝指引多語言測試</h1>
        
        <div class="language-selector">
            <button class="lang-btn active" onclick="setLanguage('zh-TW')">繁體中文</button>
            <button class="lang-btn" onclick="setLanguage('zh-CN')">简体中文</button>
            <button class="lang-btn" onclick="setLanguage('en')">English</button>
        </div>

        <div class="install-section">
            <h2 id="install-title">📱 PWA 安裝指引</h2>
            <p id="install-description">請按照以下步驟將應用程式安裝到您的裝置：</p>
            
            <ol class="install-steps">
                <li id="step1">打開瀏覽器選單（⋮ 或 ⋯）</li>
                <li id="step2">尋找「安裝應用程式」或「加到主畫面」</li>
                <li id="step3">按照提示完成安裝</li>
            </ol>

            <div class="browser-specific">
                <h3 id="browser-title">🌐 瀏覽器特定指引：</h3>
                <ul>
                    <li id="chrome-instruction">• Chrome：選單 → 安裝應用程式</li>
                    <li id="firefox-instruction">• Firefox：選單 → 安裝</li>
                    <li id="safari-instruction">• Safari：分享 → 加入主畫面</li>
                    <li id="edge-instruction">• Edge：選單 → 應用程式 → 將此網站安裝為應用程式</li>
                </ul>
            </div>
        </div>

        <div style="text-align: center;">
            <button class="test-btn" onclick="showInstallDialog()" id="show-dialog-btn">顯示安裝對話框</button>
            <button class="test-btn" onclick="testPWAInstall()" id="test-install-btn">測試 PWA 安裝</button>
            <button class="test-btn" onclick="checkPWAStatus()" id="check-status-btn">檢查 PWA 狀態</button>
        </div>

        <div class="status" id="status">
            <strong id="status-title">📊 當前狀態：</strong>
            <div id="status-content">準備就緒</div>
        </div>

        <div class="log" id="log">
            <strong id="log-title">📝 操作日誌：</strong>
            <div id="log-content"></div>
        </div>
    </div>

    <script>
        let currentLanguage = 'zh-TW';
        let deferredPrompt = null;

        // 多語言翻譯
        const translations = {
            'zh-TW': {
                title: '🌐 PWA 安裝指引多語言測試',
                installTitle: '📱 PWA 安裝指引',
                installDescription: '請按照以下步驟將應用程式安裝到您的裝置：',
                step1: '打開瀏覽器選單（⋮ 或 ⋯）',
                step2: '尋找「安裝應用程式」或「加到主畫面」',
                step3: '按照提示完成安裝',
                browserTitle: '🌐 瀏覽器特定指引：',
                chromeInstruction: '• Chrome：選單 → 安裝應用程式',
                firefoxInstruction: '• Firefox：選單 → 安裝',
                safariInstruction: '• Safari：分享 → 加入主畫面',
                edgeInstruction: '• Edge：選單 → 應用程式 → 將此網站安裝為應用程式',
                showDialogBtn: '顯示安裝對話框',
                testInstallBtn: '測試 PWA 安裝',
                checkStatusBtn: '檢查 PWA 狀態',
                statusTitle: '📊 當前狀態：',
                logTitle: '📝 操作日誌：',
                ready: '準備就緒'
            },
            'zh-CN': {
                title: '🌐 PWA 安装指引多语言测试',
                installTitle: '📱 PWA 安装指引',
                installDescription: '请按照以下步骤将应用程序安装到您的设备：',
                step1: '打开浏览器菜单（⋮ 或 ⋯）',
                step2: '寻找「安装应用」或「添加到主屏幕」',
                step3: '按照提示完成安装',
                browserTitle: '🌐 浏览器特定指引：',
                chromeInstruction: '• Chrome：菜单 → 安装应用',
                firefoxInstruction: '• Firefox：菜单 → 安装',
                safariInstruction: '• Safari：分享 → 添加到主屏幕',
                edgeInstruction: '• Edge：菜单 → 应用 → 将此站点安装为应用',
                showDialogBtn: '显示安装对话框',
                testInstallBtn: '测试 PWA 安装',
                checkStatusBtn: '检查 PWA 状态',
                statusTitle: '📊 当前状态：',
                logTitle: '📝 操作日志：',
                ready: '准备就绪'
            },
            'en': {
                title: '🌐 PWA Install Instructions Multi-language Test',
                installTitle: '📱 PWA Installation Guide',
                installDescription: 'Follow these steps to install the app on your device:',
                step1: 'Open browser menu (⋮ or ⋯)',
                step2: 'Look for "Install app" or "Add to Home screen"',
                step3: 'Follow the prompts to complete installation',
                browserTitle: '🌐 Browser-specific instructions:',
                chromeInstruction: '• Chrome: Menu → Install app',
                firefoxInstruction: '• Firefox: Menu → Install',
                safariInstruction: '• Safari: Share → Add to Home Screen',
                edgeInstruction: '• Edge: Menu → Apps → Install this site as an app',
                showDialogBtn: 'Show Install Dialog',
                testInstallBtn: 'Test PWA Install',
                checkStatusBtn: 'Check PWA Status',
                statusTitle: '📊 Current Status:',
                logTitle: '📝 Operation Log:',
                ready: 'Ready'
            }
        };

        // 設置語言
        function setLanguage(lang) {
            currentLanguage = lang;
            updateUI();
            updateActiveLanguageButton();
            log(`語言已切換到: ${lang}`);
        }

        // 更新 UI 文字
        function updateUI() {
            const t = translations[currentLanguage];
            
            document.getElementById('title').textContent = t.title;
            document.getElementById('install-title').textContent = t.installTitle;
            document.getElementById('install-description').textContent = t.installDescription;
            document.getElementById('step1').textContent = t.step1;
            document.getElementById('step2').textContent = t.step2;
            document.getElementById('step3').textContent = t.step3;
            document.getElementById('browser-title').textContent = t.browserTitle;
            document.getElementById('chrome-instruction').textContent = t.chromeInstruction;
            document.getElementById('firefox-instruction').textContent = t.firefoxInstruction;
            document.getElementById('safari-instruction').textContent = t.safariInstruction;
            document.getElementById('edge-instruction').textContent = t.edgeInstruction;
            document.getElementById('show-dialog-btn').textContent = t.showDialogBtn;
            document.getElementById('test-install-btn').textContent = t.testInstallBtn;
            document.getElementById('check-status-btn').textContent = t.checkStatusBtn;
            document.getElementById('status-title').innerHTML = `<strong>${t.statusTitle}</strong>`;
            document.getElementById('log-title').innerHTML = `<strong>${t.logTitle}</strong>`;
        }

        // 更新活動語言按鈕
        function updateActiveLanguageButton() {
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            const langButtons = {
                'zh-TW': 0,
                'zh-CN': 1,
                'en': 2
            };
            
            const activeIndex = langButtons[currentLanguage];
            if (activeIndex !== undefined) {
                document.querySelectorAll('.lang-btn')[activeIndex].classList.add('active');
            }
        }

        // 日誌記錄
        function log(message) {
            const timestamp = new Date().toLocaleTimeString();
            const logContent = document.getElementById('log-content');
            logContent.innerHTML += `<div>[${timestamp}] ${message}</div>`;
            logContent.scrollTop = logContent.scrollHeight;
        }

        // 更新狀態
        function updateStatus(status) {
            document.getElementById('status-content').textContent = status;
        }

        // 顯示安裝對話框
        function showInstallDialog() {
            const t = translations[currentLanguage];
            const message = `${t.installTitle}\n\n${t.installDescription}\n\n1. ${t.step1}\n2. ${t.step2}\n3. ${t.step3}\n\n${t.browserTitle}\n${t.chromeInstruction}\n${t.firefoxInstruction}\n${t.safariInstruction}\n${t.edgeInstruction}`;
            
            alert(message);
            log(`顯示了 ${currentLanguage} 語言的安裝對話框`);
        }

        // 測試 PWA 安裝
        function testPWAInstall() {
            log('開始測試 PWA 安裝功能...');
            
            if (deferredPrompt) {
                log('找到延遲的安裝提示，嘗試觸發安裝...');
                deferredPrompt.prompt();
                
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        log('用戶接受了安裝提示');
                        updateStatus('安裝中...');
                    } else {
                        log('用戶拒絕了安裝提示');
                        updateStatus('用戶取消安裝');
                    }
                    deferredPrompt = null;
                });
            } else {
                log('沒有可用的安裝提示');
                showInstallDialog();
                updateStatus('顯示手動安裝指引');
            }
        }

        // 檢查 PWA 狀態
        function checkPWAStatus() {
            log('檢查 PWA 狀態...');
            
            const isStandalone = window.matchMedia('(display-mode: standalone)').matches;
            const isInstalled = window.navigator.standalone === true;
            const hasServiceWorker = 'serviceWorker' in navigator;
            const hasManifest = document.querySelector('link[rel="manifest"]') !== null;
            
            const status = {
                '獨立模式': isStandalone ? '是' : '否',
                '已安裝': isInstalled ? '是' : '否',
                'Service Worker 支援': hasServiceWorker ? '是' : '否',
                'Manifest 存在': hasManifest ? '是' : '否',
                '當前語言': currentLanguage,
                '安裝提示可用': deferredPrompt ? '是' : '否'
            };
            
            let statusText = '';
            for (const [key, value] of Object.entries(status)) {
                statusText += `${key}: ${value}\n`;
                log(`${key}: ${value}`);
            }
            
            updateStatus(statusText);
        }

        // 監聽 beforeinstallprompt 事件
        window.addEventListener('beforeinstallprompt', (e) => {
            log('收到 beforeinstallprompt 事件');
            e.preventDefault();
            deferredPrompt = e;
            updateStatus('PWA 可以安裝');
        });

        // 監聽 appinstalled 事件
        window.addEventListener('appinstalled', (evt) => {
            log('PWA 已成功安裝');
            updateStatus('PWA 已安裝');
            deferredPrompt = null;
        });

        // 初始化
        document.addEventListener('DOMContentLoaded', function() {
            log('頁面載入完成，初始化多語言 PWA 安裝測試');
            updateUI();
            updateActiveLanguageButton();
            checkPWAStatus();
        });
    </script>
</body>
</html> 