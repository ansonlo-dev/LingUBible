<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PWA å®‰è£æŒ‡å¼•å¤šèªè¨€æ¸¬è©¦ - LingUBible</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
        }
        .container {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        h1 {
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }
        .language-selector {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 30px;
        }
        .lang-btn {
            padding: 10px 20px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
        }
        .lang-btn:hover, .lang-btn.active {
            background: rgba(255, 255, 255, 0.2);
            border-color: rgba(255, 255, 255, 0.6);
            transform: translateY(-2px);
        }
        .install-section {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .install-steps {
            list-style: none;
            padding: 0;
        }
        .install-steps li {
            background: rgba(255, 255, 255, 0.1);
            margin: 10px 0;
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid #4CAF50;
        }
        .browser-specific {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }
        .browser-specific ul {
            list-style: none;
            padding: 0;
        }
        .browser-specific li {
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        .test-btn {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            margin: 10px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        .test-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }
        .status {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            font-family: monospace;
        }
        .log {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            font-family: monospace;
            font-size: 14px;
            max-height: 300px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 id="title">ğŸŒ PWA å®‰è£æŒ‡å¼•å¤šèªè¨€æ¸¬è©¦</h1>
        
        <div class="language-selector">
            <button class="lang-btn active" onclick="setLanguage('zh-TW')">ç¹é«”ä¸­æ–‡</button>
            <button class="lang-btn" onclick="setLanguage('zh-CN')">ç®€ä½“ä¸­æ–‡</button>
            <button class="lang-btn" onclick="setLanguage('en')">English</button>
        </div>

        <div class="install-section">
            <h2 id="install-title">ğŸ“± PWA å®‰è£æŒ‡å¼•</h2>
            <p id="install-description">è«‹æŒ‰ç…§ä»¥ä¸‹æ­¥é©Ÿå°‡æ‡‰ç”¨ç¨‹å¼å®‰è£åˆ°æ‚¨çš„è£ç½®ï¼š</p>
            
            <ol class="install-steps">
                <li id="step1">æ‰“é–‹ç€è¦½å™¨é¸å–®ï¼ˆâ‹® æˆ– â‹¯ï¼‰</li>
                <li id="step2">å°‹æ‰¾ã€Œå®‰è£æ‡‰ç”¨ç¨‹å¼ã€æˆ–ã€ŒåŠ åˆ°ä¸»ç•«é¢ã€</li>
                <li id="step3">æŒ‰ç…§æç¤ºå®Œæˆå®‰è£</li>
            </ol>

            <div class="browser-specific">
                <h3 id="browser-title">ğŸŒ ç€è¦½å™¨ç‰¹å®šæŒ‡å¼•ï¼š</h3>
                <ul>
                    <li id="chrome-instruction">â€¢ Chromeï¼šé¸å–® â†’ å®‰è£æ‡‰ç”¨ç¨‹å¼</li>
                    <li id="firefox-instruction">â€¢ Firefoxï¼šé¸å–® â†’ å®‰è£</li>
                    <li id="safari-instruction">â€¢ Safariï¼šåˆ†äº« â†’ åŠ å…¥ä¸»ç•«é¢</li>
                    <li id="edge-instruction">â€¢ Edgeï¼šé¸å–® â†’ æ‡‰ç”¨ç¨‹å¼ â†’ å°‡æ­¤ç¶²ç«™å®‰è£ç‚ºæ‡‰ç”¨ç¨‹å¼</li>
                </ul>
            </div>
        </div>

        <div style="text-align: center;">
            <button class="test-btn" onclick="showInstallDialog()" id="show-dialog-btn">é¡¯ç¤ºå®‰è£å°è©±æ¡†</button>
            <button class="test-btn" onclick="testPWAInstall()" id="test-install-btn">æ¸¬è©¦ PWA å®‰è£</button>
            <button class="test-btn" onclick="checkPWAStatus()" id="check-status-btn">æª¢æŸ¥ PWA ç‹€æ…‹</button>
        </div>

        <div class="status" id="status">
            <strong id="status-title">ğŸ“Š ç•¶å‰ç‹€æ…‹ï¼š</strong>
            <div id="status-content">æº–å‚™å°±ç·’</div>
        </div>

        <div class="log" id="log">
            <strong id="log-title">ğŸ“ æ“ä½œæ—¥èªŒï¼š</strong>
            <div id="log-content"></div>
        </div>
    </div>

    <script>
        let currentLanguage = 'zh-TW';
        let deferredPrompt = null;

        // å¤šèªè¨€ç¿»è­¯
        const translations = {
            'zh-TW': {
                title: 'ğŸŒ PWA å®‰è£æŒ‡å¼•å¤šèªè¨€æ¸¬è©¦',
                installTitle: 'ğŸ“± PWA å®‰è£æŒ‡å¼•',
                installDescription: 'è«‹æŒ‰ç…§ä»¥ä¸‹æ­¥é©Ÿå°‡æ‡‰ç”¨ç¨‹å¼å®‰è£åˆ°æ‚¨çš„è£ç½®ï¼š',
                step1: 'æ‰“é–‹ç€è¦½å™¨é¸å–®ï¼ˆâ‹® æˆ– â‹¯ï¼‰',
                step2: 'å°‹æ‰¾ã€Œå®‰è£æ‡‰ç”¨ç¨‹å¼ã€æˆ–ã€ŒåŠ åˆ°ä¸»ç•«é¢ã€',
                step3: 'æŒ‰ç…§æç¤ºå®Œæˆå®‰è£',
                browserTitle: 'ğŸŒ ç€è¦½å™¨ç‰¹å®šæŒ‡å¼•ï¼š',
                chromeInstruction: 'â€¢ Chromeï¼šé¸å–® â†’ å®‰è£æ‡‰ç”¨ç¨‹å¼',
                firefoxInstruction: 'â€¢ Firefoxï¼šé¸å–® â†’ å®‰è£',
                safariInstruction: 'â€¢ Safariï¼šåˆ†äº« â†’ åŠ å…¥ä¸»ç•«é¢',
                edgeInstruction: 'â€¢ Edgeï¼šé¸å–® â†’ æ‡‰ç”¨ç¨‹å¼ â†’ å°‡æ­¤ç¶²ç«™å®‰è£ç‚ºæ‡‰ç”¨ç¨‹å¼',
                showDialogBtn: 'é¡¯ç¤ºå®‰è£å°è©±æ¡†',
                testInstallBtn: 'æ¸¬è©¦ PWA å®‰è£',
                checkStatusBtn: 'æª¢æŸ¥ PWA ç‹€æ…‹',
                statusTitle: 'ğŸ“Š ç•¶å‰ç‹€æ…‹ï¼š',
                logTitle: 'ğŸ“ æ“ä½œæ—¥èªŒï¼š',
                ready: 'æº–å‚™å°±ç·’'
            },
            'zh-CN': {
                title: 'ğŸŒ PWA å®‰è£…æŒ‡å¼•å¤šè¯­è¨€æµ‹è¯•',
                installTitle: 'ğŸ“± PWA å®‰è£…æŒ‡å¼•',
                installDescription: 'è¯·æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤å°†åº”ç”¨ç¨‹åºå®‰è£…åˆ°æ‚¨çš„è®¾å¤‡ï¼š',
                step1: 'æ‰“å¼€æµè§ˆå™¨èœå•ï¼ˆâ‹® æˆ– â‹¯ï¼‰',
                step2: 'å¯»æ‰¾ã€Œå®‰è£…åº”ç”¨ã€æˆ–ã€Œæ·»åŠ åˆ°ä¸»å±å¹•ã€',
                step3: 'æŒ‰ç…§æç¤ºå®Œæˆå®‰è£…',
                browserTitle: 'ğŸŒ æµè§ˆå™¨ç‰¹å®šæŒ‡å¼•ï¼š',
                chromeInstruction: 'â€¢ Chromeï¼šèœå• â†’ å®‰è£…åº”ç”¨',
                firefoxInstruction: 'â€¢ Firefoxï¼šèœå• â†’ å®‰è£…',
                safariInstruction: 'â€¢ Safariï¼šåˆ†äº« â†’ æ·»åŠ åˆ°ä¸»å±å¹•',
                edgeInstruction: 'â€¢ Edgeï¼šèœå• â†’ åº”ç”¨ â†’ å°†æ­¤ç«™ç‚¹å®‰è£…ä¸ºåº”ç”¨',
                showDialogBtn: 'æ˜¾ç¤ºå®‰è£…å¯¹è¯æ¡†',
                testInstallBtn: 'æµ‹è¯• PWA å®‰è£…',
                checkStatusBtn: 'æ£€æŸ¥ PWA çŠ¶æ€',
                statusTitle: 'ğŸ“Š å½“å‰çŠ¶æ€ï¼š',
                logTitle: 'ğŸ“ æ“ä½œæ—¥å¿—ï¼š',
                ready: 'å‡†å¤‡å°±ç»ª'
            },
            'en': {
                title: 'ğŸŒ PWA Install Instructions Multi-language Test',
                installTitle: 'ğŸ“± PWA Installation Guide',
                installDescription: 'Follow these steps to install the app on your device:',
                step1: 'Open browser menu (â‹® or â‹¯)',
                step2: 'Look for "Install app" or "Add to Home screen"',
                step3: 'Follow the prompts to complete installation',
                browserTitle: 'ğŸŒ Browser-specific instructions:',
                chromeInstruction: 'â€¢ Chrome: Menu â†’ Install app',
                firefoxInstruction: 'â€¢ Firefox: Menu â†’ Install',
                safariInstruction: 'â€¢ Safari: Share â†’ Add to Home Screen',
                edgeInstruction: 'â€¢ Edge: Menu â†’ Apps â†’ Install this site as an app',
                showDialogBtn: 'Show Install Dialog',
                testInstallBtn: 'Test PWA Install',
                checkStatusBtn: 'Check PWA Status',
                statusTitle: 'ğŸ“Š Current Status:',
                logTitle: 'ğŸ“ Operation Log:',
                ready: 'Ready'
            }
        };

        // è¨­ç½®èªè¨€
        function setLanguage(lang) {
            currentLanguage = lang;
            updateUI();
            updateActiveLanguageButton();
            log(`èªè¨€å·²åˆ‡æ›åˆ°: ${lang}`);
        }

        // æ›´æ–° UI æ–‡å­—
        function updateUI() {
            const t = translations[currentLanguage];
            
            document.getElementById('title').textContent = t.title;
            document.getElementById('install-title').textContent = t.installTitle;
            document.getElementById('install-description').textContent = t.installDescription;
            document.getElementById('step1').textContent = t.step1;
            document.getElementById('step2').textContent = t.step2;
            document.getElementById('step3').textContent = t.step3;
            document.getElementById('browser-title').textContent = t.browserTitle;
            document.getElementById('chrome-instruction').textContent = t.chromeInstruction;
            document.getElementById('firefox-instruction').textContent = t.firefoxInstruction;
            document.getElementById('safari-instruction').textContent = t.safariInstruction;
            document.getElementById('edge-instruction').textContent = t.edgeInstruction;
            document.getElementById('show-dialog-btn').textContent = t.showDialogBtn;
            document.getElementById('test-install-btn').textContent = t.testInstallBtn;
            document.getElementById('check-status-btn').textContent = t.checkStatusBtn;
            document.getElementById('status-title').innerHTML = `<strong>${t.statusTitle}</strong>`;
            document.getElementById('log-title').innerHTML = `<strong>${t.logTitle}</strong>`;
        }

        // æ›´æ–°æ´»å‹•èªè¨€æŒ‰éˆ•
        function updateActiveLanguageButton() {
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            const langButtons = {
                'zh-TW': 0,
                'zh-CN': 1,
                'en': 2
            };
            
            const activeIndex = langButtons[currentLanguage];
            if (activeIndex !== undefined) {
                document.querySelectorAll('.lang-btn')[activeIndex].classList.add('active');
            }
        }

        // æ—¥èªŒè¨˜éŒ„
        function log(message) {
            const timestamp = new Date().toLocaleTimeString();
            const logContent = document.getElementById('log-content');
            logContent.innerHTML += `<div>[${timestamp}] ${message}</div>`;
            logContent.scrollTop = logContent.scrollHeight;
        }

        // æ›´æ–°ç‹€æ…‹
        function updateStatus(status) {
            document.getElementById('status-content').textContent = status;
        }

        // é¡¯ç¤ºå®‰è£å°è©±æ¡†
        function showInstallDialog() {
            const t = translations[currentLanguage];
            const message = `${t.installTitle}\n\n${t.installDescription}\n\n1. ${t.step1}\n2. ${t.step2}\n3. ${t.step3}\n\n${t.browserTitle}\n${t.chromeInstruction}\n${t.firefoxInstruction}\n${t.safariInstruction}\n${t.edgeInstruction}`;
            
            alert(message);
            log(`é¡¯ç¤ºäº† ${currentLanguage} èªè¨€çš„å®‰è£å°è©±æ¡†`);
        }

        // æ¸¬è©¦ PWA å®‰è£
        function testPWAInstall() {
            log('é–‹å§‹æ¸¬è©¦ PWA å®‰è£åŠŸèƒ½...');
            
            if (deferredPrompt) {
                log('æ‰¾åˆ°å»¶é²çš„å®‰è£æç¤ºï¼Œå˜—è©¦è§¸ç™¼å®‰è£...');
                deferredPrompt.prompt();
                
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        log('ç”¨æˆ¶æ¥å—äº†å®‰è£æç¤º');
                        updateStatus('å®‰è£ä¸­...');
                    } else {
                        log('ç”¨æˆ¶æ‹’çµ•äº†å®‰è£æç¤º');
                        updateStatus('ç”¨æˆ¶å–æ¶ˆå®‰è£');
                    }
                    deferredPrompt = null;
                });
            } else {
                log('æ²’æœ‰å¯ç”¨çš„å®‰è£æç¤º');
                showInstallDialog();
                updateStatus('é¡¯ç¤ºæ‰‹å‹•å®‰è£æŒ‡å¼•');
            }
        }

        // æª¢æŸ¥ PWA ç‹€æ…‹
        function checkPWAStatus() {
            log('æª¢æŸ¥ PWA ç‹€æ…‹...');
            
            const isStandalone = window.matchMedia('(display-mode: standalone)').matches;
            const isInstalled = window.navigator.standalone === true;
            const hasServiceWorker = 'serviceWorker' in navigator;
            const hasManifest = document.querySelector('link[rel="manifest"]') !== null;
            
            const status = {
                'ç¨ç«‹æ¨¡å¼': isStandalone ? 'æ˜¯' : 'å¦',
                'å·²å®‰è£': isInstalled ? 'æ˜¯' : 'å¦',
                'Service Worker æ”¯æ´': hasServiceWorker ? 'æ˜¯' : 'å¦',
                'Manifest å­˜åœ¨': hasManifest ? 'æ˜¯' : 'å¦',
                'ç•¶å‰èªè¨€': currentLanguage,
                'å®‰è£æç¤ºå¯ç”¨': deferredPrompt ? 'æ˜¯' : 'å¦'
            };
            
            let statusText = '';
            for (const [key, value] of Object.entries(status)) {
                statusText += `${key}: ${value}\n`;
                log(`${key}: ${value}`);
            }
            
            updateStatus(statusText);
        }

        // ç›£è½ beforeinstallprompt äº‹ä»¶
        window.addEventListener('beforeinstallprompt', (e) => {
            log('æ”¶åˆ° beforeinstallprompt äº‹ä»¶');
            e.preventDefault();
            deferredPrompt = e;
            updateStatus('PWA å¯ä»¥å®‰è£');
        });

        // ç›£è½ appinstalled äº‹ä»¶
        window.addEventListener('appinstalled', (evt) => {
            log('PWA å·²æˆåŠŸå®‰è£');
            updateStatus('PWA å·²å®‰è£');
            deferredPrompt = null;
        });

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            log('é é¢è¼‰å…¥å®Œæˆï¼Œåˆå§‹åŒ–å¤šèªè¨€ PWA å®‰è£æ¸¬è©¦');
            updateUI();
            updateActiveLanguageButton();
            checkPWAStatus();
        });
    </script>
</body>
</html> 