# 郵件模板預覽工具

## 概述

郵件模板預覽工具允許開發者在本地預覽所有郵件模板，無需實際發送郵件。這個工具對於測試郵件外觀、調試樣式問題和驗證多語言支援非常有用。

## 功能特色

### 📧 支援的郵件類型
- **驗證碼郵件** - 用戶註冊和登入驗證
- **密碼重設郵件** - 忘記密碼功能
- **聯絡表單郵件** - 聯絡我們表單提交

### 🌍 多語言支援
- 繁體中文 (zh-TW)
- 簡體中文 (zh-CN)
- 英文 (en)

### 🎨 主題支援
- **亮色主題** - 白色背景，適合日間使用
- **暗色主題** - 深色背景，適合夜間使用

### ⚙️ 可自訂參數
- **驗證碼郵件**: 自訂驗證碼
- **密碼重設郵件**: 自訂用戶 ID 和重設令牌
- **聯絡表單郵件**: 自訂姓名、郵件地址和訊息內容

## 開發模式控制

**重要**：此功能僅在開發模式啟用時可用。

### 啟用測試頁面

在 `.env` 文件中設置：
```env
VITE_DEV_MODE=true
```

### 禁用測試頁面

在 `.env` 文件中設置：
```env
VITE_DEV_MODE=false
```

當 `VITE_DEV_MODE=false` 時：
- 側邊欄中不會顯示「郵件預覽」連結
- 直接訪問 `/email-preview` 路由會自動重定向到首頁
- 所有開發工具相關功能都會被禁用

## 如何使用

### 1. 訪問預覽工具

確保 `.env` 文件中 `VITE_DEV_MODE=true`，然後郵件預覽工具會自動出現在側邊欄的「開發工具」區域：

```
側邊欄 → 開發工具 → 郵件預覽
```

或直接訪問：`http://localhost:5173/email-preview`

### 2. 設定選項

1. **選擇郵件類型**：從下拉選單中選擇要預覽的郵件類型
2. **選擇語言**：選擇郵件的顯示語言
3. **選擇主題**：選擇亮色或暗色主題
4. **填寫參數**：根據選擇的郵件類型填寫相關參數

### 3. 生成預覽

點擊「生成預覽」按鈕，郵件預覽會在右側面板中顯示。

### 4. 檢查效果

- 檢查郵件的整體佈局和樣式
- 驗證文字內容和翻譯
- 測試響應式設計（手機版適配）
- 確認主題色彩搭配

## 技術實現

### 前端組件
- **位置**: `src/pages/EmailPreview.tsx`
- **路由**: `/email-preview`
- **權限**: 僅在開發模式 (`VITE_DEV_MODE=true`) 下可用
- **路由保護**: 使用 `DevModeRoute` 組件保護

### 郵件模板工具
- **位置**: `src/utils/email-templates.ts`
- **功能**: 提供前端郵件模板生成函數
- **特色**: 與後端模板保持一致的樣式和結構

### 樣式配置
郵件模板使用與主應用一致的顏色變數：
- 亮色主題容器背景: `#f5f5f5`
- 暗色主題容器背景: `#0f0f0f`
- 暗色主題代碼容器: `#18171b`（無邊框，白色文字）

## 開發注意事項

### 1. 僅開發模式可用
郵件預覽工具僅在開發模式啟用時可用（`VITE_DEV_MODE=true`），生產環境會自動隱藏並重定向。

### 路由保護機制
- 使用 `DevModeRoute` 組件包裝測試頁面
- 檢查 `APP_CONFIG.DEV_MODE.ENABLED` 狀態
- 未啟用時自動重定向到首頁

### 2. 模板同步
前端預覽模板 (`src/utils/email-templates.ts`) 應與後端模板保持同步：
- `functions/send-verification-email/src/email-template.js`
- `functions/send-verification-email/src/password-reset-template.js`
- `functions/send-verification-email/src/contact-form-template.js`

### 3. 樣式測試
使用預覽工具測試：
- 不同語言的文字長度適配
- 暗色主題的對比度
- 手機版響應式佈局
- 郵件客戶端兼容性

## 故障排除

### 預覽不顯示
1. 確認在開發模式下運行
2. 檢查瀏覽器控制台是否有錯誤
3. 確認所有必要參數已填寫

### 樣式問題
1. 檢查 CSS 變數是否正確
2. 確認主題切換功能正常
3. 測試不同瀏覽器的兼容性

### 翻譯問題
1. 確認翻譯鍵值存在於 `src/utils/email-templates.ts`
2. 檢查語言代碼是否正確 (`zh-TW`, `zh-CN`, `en`)
3. 驗證翻譯內容的準確性

## 未來改進

- [ ] 支援更多郵件類型
- [ ] 添加郵件客戶端預覽模式
- [ ] 支援自訂 CSS 樣式
- [ ] 添加郵件性能分析
- [ ] 支援批量預覽功能 